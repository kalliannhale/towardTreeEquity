layer_name: tree_narratives
description: >
  A structured layer for holding narrative, cultural, and community memory data associated with individual trees.
  This includes memorial stories, public hopes, community designations, and symbolic meanings.
  Narratives are linked to specific `tree_id` values and may carry consent status, attribution, and versioning.

version: 1.0
geometry_type: Point
crs: EPSG:4326
unit: narrative
primary_key: [tree_id, narrative_version]

linked_to: tree_canopy
join_key: tree_id

fields:
  - name: tree_id
    type: string
    required: true
    field_class: spatial

  - name: narrative_version
    type: integer
    required: true
    field_class: temporal
    notes: use for revision control

  - name: narrative_field
    type: string
    required: true
    field_class: narrative
    notes: long-form text; markdown supported

  - name: memorial_tag
    type: string
    required: false
    field_class: categorical
    notes: e.g. ["memorial", "witness", "dedication"]

  - name: contributor_name
    type: string
    required: false
    field_class: narrative

  - name: contributor_org
    type: string
    required: false
    field_class: narrative

  - name: community_priority_score
    type: number
    required: false
    field_class: indexed
    notes: derived from participatory voting or story frequency

  - name: story_date
    type: date
    required: false
    field_class: temporal

  - name: narrative_visibility
    type: string
    required: true
    field_class: categorical
    valid_values: ["public", "private", "conditional"]

  - name: consent_status
    type: string
    required: true
    field_class: categorical
    valid_values: ["consented", "withdrawn", "pending"]
    notes: governed by `narrative_governance.yaml`

  - name: tags
    type: list[string]
    required: false
    field_class: narrative
    notes: e.g. ["healing", "remembrance", "pollinator"]

  - name: narrative_summary
    type: string
    required: false
    field_class: latent
    notes: generated via ML or community tagging

  - name: ingestion_date
    type: date
    required: true
    field_class: temporal

  - name: transformation_log
    type: string
    required: false
    field_class: derived
