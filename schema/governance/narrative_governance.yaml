layer_name: tree_narratives
description: >
  A structured layer for holding narrative, cultural, maintenance, and community memory data associated with individual trees.
  This includes stories, public hopes, memorials, labor logs, and inspection notes. Narratives are linked to `tree_id`,
  and may carry consent status, attribution, and versioning.

version: 1.1
geometry_type: Point
crs: EPSG:4326
unit: narrative
primary_key: [tree_id, narrative_version]

linked_to: tree_canopy
join_key: tree_id

fields:
  - name: tree_id
    type: string
    required: true
    field_class: spatial

  - name: narrative_version
    type: integer
    required: true
    field_class: temporal
    notes: use for revision control

  - name: narrative_field
    type: string
    required: false
    field_class: narrative
    notes: markdown supported; may include poetry, stories, reflections

  - name: maintenance_note
    type: string
    required: false
    field_class: narrative
    notes: used for inspection notes, care logs, or urgent reports

  - name: note_type
    type: string
    required: false
    field_class: categorical
    valid_values: ["maintenance", "observation", "community_story", "memorial", "other"]

  - name: contributor_name
    type: string
    required: false
    field_class: narrative

  - name: contributor_org
    type: string
    required: false
    field_class: narrative

  - name: submitted_by
    type: string
    required: false
    field_class: narrative
    notes: e.g. "Arborist Team 3", "Youth Naturalists", or individual name

  - name: submission_type
    type: string
    required: false
    field_class: categorical
    valid_values: ["municipal", "community", "automated", "uncategorized"]

  - name: green_labor_hours
    type: number
    required: false
    field_class: economic
    notes: optional field to estimate time invested in tree care

  - name: community_priority_score
    type: number
    required: false
    field_class: indexed
    notes: derived from participatory processes or storytelling votes

  - name: memorial_tag
    type: string
    required: false
    field_class: categorical
    notes: e.g. ["memorial", "dedication", "witness"]

  - name: tags
    type: list[string]
    required: false
    field_class: narrative
    notes: e.g. ["healing", "pollinator", "climate grief", "resistance"]

  - name: narrative_summary
    type: string
    required: false
    field_class: latent
    notes: may be generated by ML or condensed by humans

  - name: narrative_visibility
    type: string
    required: true
    field_class: categorical
    valid_values: ["public", "private", "conditional"]

  - name: consent_status
    type: string
    required: true
    field_class: categorical
    valid_values: ["consented", "withdrawn", "pending"]
    notes: governed by narrative_governance.yaml

  - name: ingestion_date
    type: date
    required: true
    field_class: temporal

  - name: transformation_log
    type: string
    required: false
    field_class: derived
